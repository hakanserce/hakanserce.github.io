<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>jq: Ad hoc JSON processing made easy - Learn Forever</title>
  <meta name="description" content="Nowadays, a developer needs to deal with JSON quite frequently. RESTful web services are everywhere. Whether you need to work with Elasticsearch, DynamoDB, Neo4j, Titan, or an internal Restful API for a web application you will probably end up dealing with JSON.">
  <meta name="author" content="Hakan Serce"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Learn Forever",
    
    "url": "http:\/\/blog.hakanserce.com\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "http:\/\/blog.hakanserce.com\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "http:\/\/blog.hakanserce.com\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "http:\/\/blog.hakanserce.com\/post\/jq\/",
          "name": "Jq ad hoc j s o n processing made easy"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Hakan Serce"
  },
  "headline": "jq: Ad hoc JSON processing made easy",
  "description" : "Nowadays, a developer needs to deal with JSON quite frequently. RESTful web services are everywhere. Whether you need to work with Elasticsearch, DynamoDB, Neo4j, Titan, or an internal Restful API for a web application you will probably end up dealing with JSON.\n",
  "inLanguage" : "en",
  "wordCount":  1586 ,
  "datePublished" : "2017-12-20T21:55:00",
  "dateModified" : "2017-12-20T21:55:00",
  "image" : "http:\/\/blog.hakanserce.com\/img\/hakan-serce.jpeg",
  "keywords" : [ "programming, tools, jq, json" ],
  "mainEntityOfPage" : "http:\/\/blog.hakanserce.com\/post\/jq\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "http:\/\/blog.hakanserce.com\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "http:\/\/blog.hakanserce.com\/img\/hakan-serce.jpeg",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="jq: Ad hoc JSON processing made easy" />
<meta property="og:description" content="Nowadays, a developer needs to deal with JSON quite frequently. RESTful web services are everywhere. Whether you need to work with Elasticsearch, DynamoDB, Neo4j, Titan, or an internal Restful API for a web application you will probably end up dealing with JSON.">
<meta property="og:image" content="http://blog.hakanserce.com/img/hakan-serce.jpeg" />
<meta property="og:url" content="http://blog.hakanserce.com/post/jq/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Learn Forever" />

  <meta name="twitter:title" content="jq: Ad hoc JSON processing made easy" />
  <meta name="twitter:description" content="Nowadays, a developer needs to deal with JSON quite frequently. RESTful web services are everywhere. Whether you need to work with Elasticsearch, DynamoDB, Neo4j, Titan, or an internal Restful API for â€¦">
  <meta name="twitter:image" content="http://blog.hakanserce.com/img/hakan-serce.jpeg" />
  <meta name="twitter:card" content="summary" />
  <link href='http://blog.hakanserce.com/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.79.1" />
  <link rel="alternate" href="http://blog.hakanserce.com/index.xml" type="application/rss+xml" title="Learn Forever"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="http://blog.hakanserce.com/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="http://blog.hakanserce.com/css/highlight.min.css" /><link rel="stylesheet" href="http://blog.hakanserce.com/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-108428709-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://blog.hakanserce.com/">Learn Forever</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Learn Forever" href="http://blog.hakanserce.com/">
            <img class="avatar-img" src="http://blog.hakanserce.com/img/hakan-serce.jpeg" alt="Learn Forever" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>jq: Ad hoc JSON processing made easy</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on December 20, 2017
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;8&nbsp;minutes
  
  
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>Nowadays, a developer needs to deal with JSON quite frequently. RESTful web services are everywhere. Whether you need to work with Elasticsearch, DynamoDB, Neo4j, Titan, or an internal Restful API for a web application you will probably end up dealing with JSON.</p>
<p>Similarly if you are trying to interact with a web service API like Evernote, Pocket or Twitter you will need to deal with JSON all the same.</p>
<p>There are numerous libraries available in almost all programming languages to work with JSON (See <a href="http://www.json.org">json.org</a> for a list). These libraries are the way to go when we are building production code, using the programming language of choice. Sometimes, however, all we need is to run some ad hoc requests and check the results. It is too much pain to just go ahead and write a program, or script for such cases. For instance, sometimes we just need to run a query against Elasticsearch and then get a specific field value out of the JSON response. Or maybe all we need is to dump a few field values from a query result in CSV format. Well, <code>jq</code> comes to the rescue!</p>
<p><code>jq</code> - not to be confused with <code>jQuery</code> - is a command line tool that lets you manipulate JSON. As we will see in examples below, it is a very sophisticated tool for JSON processing with capabilites ranging from selecting fields, to filtering to exporting to CSV, and a lot more.</p>
<p>Enough said, let&rsquo;s dive in.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#basic-usage">Basic Usage</a>
<ul>
<li><a href="#pretty-printing-json">Pretty Printing JSON</a></li>
<li><a href="#selecting-a-field">Selecting a field</a></li>
<li><a href="#selecting-a-field-using-python">Selecting a field using Python</a></li>
<li><a href="#printing-more-than-one-field--as-an-array">Printing more than one field (as an array)</a></li>
<li><a href="#printing-more-than-one-field--as-an-object">Printing more than one field (as an object)</a></li>
</ul>
</li>
<li><a href="#more-advanced-examples">More Advanced Examples</a>
<ul>
<li><a href="#filtering-data">Filtering data</a></li>
<li><a href="#exporting-data-as-a-tsv-file">Exporting data as a tsv file</a></li>
<li><a href="#adding-headers-to-a-tsv-exported-data">Adding headers to a tsv exported data</a></li>
<li><a href="#seeing-the-fields-available-to-use">Seeing the fields available to use</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<!-- raw HTML omitted -->
<h2 id="basic-usage">Basic Usage</h2>
<p>We will download USGS Earthquake data in this section to show a few examples of how <code>jq</code> can be used to process JSON.</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">  curl <span class="s1">&#39;https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&amp;starttime=2014-01-01&amp;endtime=2014-01-02&#39;</span> &gt; earthquake.json
</code></pre></div><p>With the above command, we download information about a list of earthquakes using <code>curl</code> and save into the file <code>earthquake.json</code>.</p>
<p>The file contains <code>290</code> lines, and a sample line is shown below.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">{&#34;type&#34;:&#34;FeatureCollection&#34;,&#34;metadata&#34;:{&#34;generated&#34;:1513583848000,&#34;url&#34;:&#34;https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&amp;starttime=2014-01-01&amp;endtime=2014-01-02&#34;,&#34;title&#34;:&#34;USGS Earthquakes&#34;,&#34;status&#34;:200,&#34;api&#34;:&#34;1.5.8&#34;,&#34;count&#34;:291},&#34;features&#34;:[{&#34;type&#34;:&#34;Feature&#34;,&#34;properties&#34;:{&#34;mag&#34;:1.29,&#34;place&#34;:&#34;10km SSW of Idyllwild, CA&#34;,&#34;time&#34;:1388620296020,&#34;updated&#34;:1457728844428,&#34;tz&#34;:-480,&#34;url&#34;:&#34;https://earthquake.usgs.gov/earthquakes/eventpage/ci11408890&#34;,&#34;detail&#34;:&#34;https://earthquake.usgs.gov/fdsnws/event/1/query?eventid=ci11408890&amp;format=geojson&#34;,&#34;felt&#34;:null,&#34;cdi&#34;:null,&#34;mmi&#34;:null,&#34;alert&#34;:null,&#34;status&#34;:&#34;reviewed&#34;,&#34;tsunami&#34;:0,&#34;sig&#34;:26,&#34;net&#34;:&#34;ci&#34;,&#34;code&#34;:&#34;11408890&#34;,&#34;ids&#34;:&#34;,ci11408890,&#34;,&#34;sources&#34;:&#34;,ci,&#34;,&#34;types&#34;:&#34;,cap,focal-mechanism,general-link,geoserve,nearby-cities,origin,phase-data,scitech-link,&#34;,&#34;nst&#34;:39,&#34;dmin&#34;:0.06729,&#34;rms&#34;:0.09,&#34;gap&#34;:51,&#34;magType&#34;:&#34;ml&#34;,&#34;type&#34;:&#34;earthquake&#34;,&#34;title&#34;:&#34;M 1.3 - 10km SSW of Idyllwild, CA&#34;},&#34;geometry&#34;:{&#34;type&#34;:&#34;Point&#34;,&#34;coordinates&#34;:[-116.7776667,33.6633333,11.008]},&#34;id&#34;:&#34;ci11408890&#34;},
</code></pre></div><h3 id="pretty-printing-json">Pretty Printing JSON</h3>
<p>Note that the result above is a very long line of JSON, and it is not really easy to see the contents this way. It is probably better to take a look at some portion of it pretty formatted. Just using <code>jq '.'</code> gives us the formatting needed as shown below.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh"> cat earthquake.json <span class="p">|</span> jq <span class="s1">&#39;.&#39;</span> <span class="p">|</span> head -n <span class="m">20</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">{
  &#34;type&#34;: &#34;FeatureCollection&#34;,
  &#34;metadata&#34;: {
    &#34;generated&#34;: 1513583848000,
    &#34;url&#34;: &#34;https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&amp;starttime=2014-01-01&amp;endtime=2014-01-02&#34;,
    &#34;title&#34;: &#34;USGS Earthquakes&#34;,
    &#34;status&#34;: 200,
    &#34;api&#34;: &#34;1.5.8&#34;,
    &#34;count&#34;: 291
  },
  &#34;features&#34;: [
    {
      &#34;type&#34;: &#34;Feature&#34;,
      &#34;properties&#34;: {
        &#34;mag&#34;: 1.29,
        &#34;place&#34;: &#34;10km SSW of Idyllwild, CA&#34;,
        &#34;time&#34;: 1388620296020,
        &#34;updated&#34;: 1457728844428,
        &#34;tz&#34;: -480,
        &#34;url&#34;: &#34;https://earthquake.usgs.gov/earthquakes/eventpage/ci11408890&#34;,
</code></pre></div><h3 id="selecting-a-field">Selecting a field</h3>
<p>This is probably the most common use case for <code>jq</code>. We just want to show the titles of all the earthquakes in the file.</p>
<p>Here is how we do it.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">  cat earthquake.json <span class="p">|</span> jq <span class="s1">&#39;.features[].properties.title&#39;</span>
</code></pre></div><p>Showing 3 lines of total 292 lines below:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">&#34;M 1.3 - 10km SSW of Idyllwild, CA&#34;
&#34;M 1.1 - 117km NW of Talkeetna, Alaska&#34;
&#34;M 1.3 - 6km SSW of Big Lake, Alaska&#34;
</code></pre></div><p>This is something I need when dealing with Elasticsearch query results a lot. In those cases, just something like  <code>jq .hits.hits[]._source.&lt;field_name&gt;</code> is a huge life saver.</p>
<h3 id="selecting-a-field-using-python">Selecting a field using Python</h3>
<p>For comparison, here I also included how you would do this in Python.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python">       <span class="kn">import</span> <span class="nn">json</span>

       <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;earthquake.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
       <span class="n">js</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
       <span class="nb">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

       <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">js</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]:</span>
         <span class="k">print</span> <span class="n">feature</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
</code></pre></div><p>Not that bad actually, but still it is not comparable to the beautifully concise <code>jq</code> one liner.</p>
<h3 id="printing-more-than-one-field--as-an-array">Printing more than one field (as an array)</h3>
<p>Now let&rsquo;s get this more sophisticated. Say, we would like to select two fields now, and show them as a JSON array.</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">   cat earthquake.json <span class="p">|</span> jq <span class="s1">&#39;.features[].properties | [.mag, .place]&#39;</span> <span class="p">|</span> head
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">[
  1.29,
  &#34;10km SSW of Idyllwild, CA&#34;
]
[
  1.1,
  &#34;117km NW of Talkeetna, Alaska&#34;
]
[
  1.3,
</code></pre></div><p>This looks fine, but a bit ugly. Why not just show an array per line? We can do this with the <code>-c</code> argument of <code>jq</code>. This argument tells <code>jq</code> to print the results in a compact way.</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">   cat earthquake.json <span class="p">|</span> jq -c <span class="s1">&#39;.features[].properties | [.mag, .place]&#39;</span> <span class="p">|</span> head
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">[1.29,&#34;10km SSW of Idyllwild, CA&#34;]
[1.1,&#34;117km NW of Talkeetna, Alaska&#34;]
[1.3,&#34;6km SSW of Big Lake, Alaska&#34;]
[1.4,&#34;63km NW of Talkeetna, Alaska&#34;]
[4,&#34;27km WNW of Coquimbo, Chile&#34;]
[0.53,&#34;4km NW of The Geysers, California&#34;]
[0.7,&#34;6km E of Mammoth Lakes, California&#34;]
[0.47,&#34;11km ESE of Anza, CA&#34;]
[4.2,&#34;South of the Fiji Islands&#34;]
[1.8,&#34;74km SW of Unalaska, Alaska&#34;]
</code></pre></div><h3 id="printing-more-than-one-field--as-an-object">Printing more than one field (as an object)</h3>
<p>Sometimes just printing fields side by side is not good enough, you might need the field names for the fields. One of the better ways to do that is to output a JSON object instead of an array in these cases.</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">  cat earthquake.json <span class="p">|</span> jq -c <span class="s1">&#39;.features[].properties | {&#34;magnitude&#34;: .mag, &#34;location&#34;: .place}&#39;</span> <span class="p">|</span> head
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">{&#34;magnitude&#34;:1.29,&#34;location&#34;:&#34;10km SSW of Idyllwild, CA&#34;}
{&#34;magnitude&#34;:1.1,&#34;location&#34;:&#34;117km NW of Talkeetna, Alaska&#34;}
{&#34;magnitude&#34;:1.3,&#34;location&#34;:&#34;6km SSW of Big Lake, Alaska&#34;}
{&#34;magnitude&#34;:1.4,&#34;location&#34;:&#34;63km NW of Talkeetna, Alaska&#34;}
{&#34;magnitude&#34;:4,&#34;location&#34;:&#34;27km WNW of Coquimbo, Chile&#34;}
{&#34;magnitude&#34;:0.53,&#34;location&#34;:&#34;4km NW of The Geysers, California&#34;}
{&#34;magnitude&#34;:0.7,&#34;location&#34;:&#34;6km E of Mammoth Lakes, California&#34;}
{&#34;magnitude&#34;:0.47,&#34;location&#34;:&#34;11km ESE of Anza, CA&#34;}
{&#34;magnitude&#34;:4.2,&#34;location&#34;:&#34;South of the Fiji Islands&#34;}
{&#34;magnitude&#34;:1.8,&#34;location&#34;:&#34;74km SW of Unalaska, Alaska&#34;}
</code></pre></div><h2 id="more-advanced-examples">More Advanced Examples</h2>
<h3 id="filtering-data">Filtering data</h3>
<p>What if you want to just list earthquakes with a magnitude larger than 4.5? Simple, use <code>select</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">  cat earthquake.json <span class="p">|</span> jq -c <span class="s1">&#39;.features[].properties |select(.mag &gt; 4.5) | {&#34;magnitude&#34;: .mag, &#34;location&#34;: .place}&#39;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">{&#34;magnitude&#34;:4.6,&#34;location&#34;:&#34;36km WNW of Sola, Vanuatu&#34;}
{&#34;magnitude&#34;:4.7,&#34;location&#34;:&#34;69km ENE of Amahai, Indonesia&#34;}
{&#34;magnitude&#34;:4.7,&#34;location&#34;:&#34;46km ESE of Farallon de Pajaros, Northern Mariana Islands&#34;}
{&#34;magnitude&#34;:4.6,&#34;location&#34;:&#34;21km ESE of Pospelikha, Russia&#34;}
{&#34;magnitude&#34;:4.9,&#34;location&#34;:&#34;55km NW of Abra Pampa, Argentina&#34;}
{&#34;magnitude&#34;:6.5,&#34;location&#34;:&#34;32km W of Sola, Vanuatu&#34;}
{&#34;magnitude&#34;:4.6,&#34;location&#34;:&#34;61km WNW of Port-Vila, Vanuatu&#34;}
{&#34;magnitude&#34;:4.9,&#34;location&#34;:&#34;21km ESE of Takahagi, Japan&#34;}
{&#34;magnitude&#34;:4.9,&#34;location&#34;:&#34;East of the North Island of New Zealand&#34;}
{&#34;magnitude&#34;:4.6,&#34;location&#34;:&#34;88km SSW of Masachapa, Nicaragua&#34;}
{&#34;magnitude&#34;:4.6,&#34;location&#34;:&#34;West Chile Rise&#34;}
{&#34;magnitude&#34;:4.6,&#34;location&#34;:&#34;258km NNE of Ndoi Island, Fiji&#34;}
{&#34;magnitude&#34;:4.9,&#34;location&#34;:&#34;260km W of Kamiiso, Japan&#34;}
{&#34;magnitude&#34;:4.7,&#34;location&#34;:&#34;Southern Mid-Atlantic Ridge&#34;}
{&#34;magnitude&#34;:5.1,&#34;location&#34;:&#34;76km NNW of Davila, Philippines&#34;}
</code></pre></div><h3 id="exporting-data-as-a-tsv-file">Exporting data as a tsv file</h3>
<p>Ok, you got what you are looking for, but you actually need to export the data in tsv format maybe. Just add <code>|@tsv</code> at the end:</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">   cat earthquake.json<span class="p">|</span> jq -r <span class="s1">&#39;.features[].properties |select(.mag &gt; 4.5)| [.mag, .place]|@tsv&#39;</span>
</code></pre></div><table>
<thead>
<tr>
<th>4.6</th>
<th>36km WNW of Sola, Vanuatu</th>
</tr>
</thead>
<tbody>
<tr>
<td>4.7</td>
<td>69km ENE of Amahai, Indonesia</td>
</tr>
<tr>
<td>4.7</td>
<td>46km ESE of Farallon de Pajaros, Northern Mariana Islands</td>
</tr>
<tr>
<td>4.6</td>
<td>21km ESE of Pospelikha, Russia</td>
</tr>
<tr>
<td>4.9</td>
<td>55km NW of Abra Pampa, Argentina</td>
</tr>
<tr>
<td>6.5</td>
<td>32km W of Sola, Vanuatu</td>
</tr>
<tr>
<td>4.6</td>
<td>61km WNW of Port-Vila, Vanuatu</td>
</tr>
<tr>
<td>4.9</td>
<td>21km ESE of Takahagi, Japan</td>
</tr>
<tr>
<td>4.9</td>
<td>East of the North Island of New Zealand</td>
</tr>
<tr>
<td>4.6</td>
<td>88km SSW of Masachapa, Nicaragua</td>
</tr>
<tr>
<td>4.6</td>
<td>West Chile Rise</td>
</tr>
<tr>
<td>4.6</td>
<td>258km NNE of Ndoi Island, Fiji</td>
</tr>
<tr>
<td>4.9</td>
<td>260km W of Kamiiso, Japan</td>
</tr>
<tr>
<td>4.7</td>
<td>Southern Mid-Atlantic Ridge</td>
</tr>
<tr>
<td>5.1</td>
<td>76km NNW of Davila, Philippines</td>
</tr>
</tbody>
</table>
<p>There is also <code>@csv</code> which would allow exporting the data in CSV format.</p>
<p>Note that for TSV/CSV export you need an array, rather than a JSON object. A final note on this one is about the <code>-r</code> flag. This flag tells <code>jq</code> to generate raw output, which in this case means generating data without quotation marks.</p>
<h3 id="adding-headers-to-a-tsv-exported-data">Adding headers to a tsv exported data</h3>
<p>The previous results look great, but there is an annoyance, right? You don&rsquo;t have the headers for the fields. In order to fix this, you would simply need to add your headers/column names into the beginning of the data as follows:</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">  cat earthquake.json<span class="p">|</span> jq -r <span class="s1">&#39;[&#34;Magnitude&#34;, &#34;Place&#34;],(.features[].properties |select(.mag &gt; 4.5)| [.mag, .place])|@tsv&#39;</span>
</code></pre></div><table>
<thead>
<tr>
<th>Magnitude</th>
<th>Place</th>
</tr>
</thead>
<tbody>
<tr>
<td>4.6</td>
<td>36km WNW of Sola, Vanuatu</td>
</tr>
<tr>
<td>4.7</td>
<td>69km ENE of Amahai, Indonesia</td>
</tr>
<tr>
<td>4.7</td>
<td>46km ESE of Farallon de Pajaros, Northern Mariana Islands</td>
</tr>
<tr>
<td>4.6</td>
<td>21km ESE of Pospelikha, Russia</td>
</tr>
<tr>
<td>4.9</td>
<td>55km NW of Abra Pampa, Argentina</td>
</tr>
<tr>
<td>6.5</td>
<td>32km W of Sola, Vanuatu</td>
</tr>
<tr>
<td>4.6</td>
<td>61km WNW of Port-Vila, Vanuatu</td>
</tr>
<tr>
<td>4.9</td>
<td>21km ESE of Takahagi, Japan</td>
</tr>
<tr>
<td>4.9</td>
<td>East of the North Island of New Zealand</td>
</tr>
<tr>
<td>4.6</td>
<td>88km SSW of Masachapa, Nicaragua</td>
</tr>
<tr>
<td>4.6</td>
<td>West Chile Rise</td>
</tr>
<tr>
<td>4.6</td>
<td>258km NNE of Ndoi Island, Fiji</td>
</tr>
<tr>
<td>4.9</td>
<td>260km W of Kamiiso, Japan</td>
</tr>
<tr>
<td>4.7</td>
<td>Southern Mid-Atlantic Ridge</td>
</tr>
<tr>
<td>5.1</td>
<td>76km NNW of Davila, Philippines</td>
</tr>
</tbody>
</table>
<p>Looks much better now!</p>
<h3 id="seeing-the-fields-available-to-use">Seeing the fields available to use</h3>
<p>Sometimes we just need to know the attribute names at some point in the JSON nested object hierarchy. One way to do that is trying to look into the raw dump, but there is a much better way using <code>jq</code>.</p>
<p>Say we would like to see all the attributes under <code>features.properties</code>. Here is how we do it:</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">   cat earthquake.json <span class="p">|</span> jq <span class="s1">&#39;.features[].properties|to_entries|.[].key&#39;</span><span class="p">|</span>sort -u
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">&#34;alert&#34;
&#34;cdi&#34;
&#34;code&#34;
&#34;detail&#34;
&#34;dmin&#34;
&#34;felt&#34;
&#34;gap&#34;
&#34;ids&#34;
&#34;mag&#34;
&#34;magType&#34;
&#34;mmi&#34;
&#34;net&#34;
&#34;nst&#34;
&#34;place&#34;
&#34;rms&#34;
&#34;sig&#34;
&#34;sources&#34;
&#34;status&#34;
&#34;time&#34;
&#34;title&#34;
&#34;tsunami&#34;
&#34;type&#34;
&#34;types&#34;
&#34;tz&#34;
&#34;updated&#34;
&#34;url&#34;
</code></pre></div><p>This might seem like a lot of work to do just to show the available attributes, but as this is a pretty common functionality, you probably would define an alias/function to do this for you.</p>
<p>I have the following function, for instance, defined in my <code>.zhrc</code> file:</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh"><span class="k">function</span> jqKeys<span class="o">(){</span>
  jq <span class="s1">&#39;to_entries|.[].key&#39;</span><span class="p">|</span>sort -u
<span class="o">}</span>
</code></pre></div><p>Now, I can simply do the following:</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">   cat earthquake.json <span class="p">|</span> jq <span class="s1">&#39;.features[].properties&#39;</span> <span class="p">|</span> jqKeys
</code></pre></div><h2 id="conclusion">Conclusion</h2>
<p><code>jq</code> is a little-known beast for interacting with JSON. This post is definitely far from covering all of what <code>jq</code> has to offer. If you need to work with JSON a lot, especially for ad hoc queries, operations or troubleshooting work, I would strongly suggest you to take a look at <a href="https://stedolan.github.io/jq/manual/">jq Manual</a>.</p>

        
          <div class="blog-tags">
            
              <a href="http://blog.hakanserce.com//tags/programming/">programming</a>&nbsp;
            
              <a href="http://blog.hakanserce.com//tags/tools/">tools</a>&nbsp;
            
              <a href="http://blog.hakanserce.com//tags/jq/">jq</a>&nbsp;
            
              <a href="http://blog.hakanserce.com//tags/json/">json</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=http%3a%2f%2fblog.hakanserce.com%2fpost%2fjq%2f&amp;text=jq%3a%20Ad%20hoc%20JSON%20processing%20made%20easy&amp;via=" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fblog.hakanserce.com%2fpost%2fjq%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=http%3a%2f%2fblog.hakanserce.com%2fpost%2fjq%2f&amp;title=jq%3a%20Ad%20hoc%20JSON%20processing%20made%20easy" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=http%3a%2f%2fblog.hakanserce.com%2fpost%2fjq%2f&amp;title=jq%3a%20Ad%20hoc%20JSON%20processing%20made%20easy" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=http%3a%2f%2fblog.hakanserce.com%2fpost%2fjq%2f&amp;title=jq%3a%20Ad%20hoc%20JSON%20processing%20made%20easy" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=http%3a%2f%2fblog.hakanserce.com%2fpost%2fjq%2f&amp;description=jq%3a%20Ad%20hoc%20JSON%20processing%20made%20easy" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="http://blog.hakanserce.com/post/how-to-learn-touch-typing-a-guide-for-seasoned-hunt-and-pecker/" data-toggle="tooltip" data-placement="top" title="How to Learn Touch Typing: a Guide for Seasoned Hunt and Pecker">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="http://blog.hakanserce.com/post/outlook_automation_mac/" data-toggle="tooltip" data-placement="top" title="Links to Outlook e-mails: how I integrate Todoist and Outlook">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
          
          <div class="disqus-comments">                  
            <button id="show-comments" class="btn btn-default" type="button">Show <span class="disqus-comment-count" data-disqus-url="http://blog.hakanserce.com/post/jq">comments</span></button>
            <div id="disqus_thread"></div>

            <script type="text/javascript">
              var disqus_config = function () {
              this.page.url = 'http:\/\/blog.hakanserce.com\/post\/jq';
            };

          </script>
          </div>
          
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/hakanserce" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/hakan-serce-5419104" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/1397268/hakan-serce" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Hakan Serce
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2021
          

          
            &nbsp;&bull;&nbsp;
            <a href="http://blog.hakanserce.com/">Learn Forever</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.79.1</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="http://blog.hakanserce.com/js/main.js"></script>
<script src="http://blog.hakanserce.com/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="http://blog.hakanserce.com/js/load-photoswipe.js"></script>








<script type="text/javascript">
$(function(){
  $('#show-comments').on('click', function(){
    var disqus_shortname = 'blog-hakanserce';
      
    (function() {
      var disqus = document.createElement('script'); 
      disqus.type = 'text/javascript'; 
      disqus.async = true;
      disqus.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(disqus);
    })();
      
    $(this).hide(); 
    });
  });
      
</script>
<script id="dsq-count-scr" src="//blog-hakanserce.disqus.com/count.js" async></script>




    
  </body>
</html>

